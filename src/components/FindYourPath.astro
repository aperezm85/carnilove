---
import Card from "@/components/shared/Card.astro";

import Arrow1 from "@/assets/find-path/arrow-1.png";
import Arrow2 from "@/assets/find-path/arrow-2.png";
import Arrow3 from "@/assets/find-path/arrow-3.png";
---

<section
  id="find-your-path"
  class="pin-section relative h-dvh overflow-hidden w-full z-6"
>
  <section class="content">
    <section
      id="title"
      class="absolute top-[150px] left-[90px] flex flex-col gap-4 z-2"
    >
      <h1
        id="find-your-path-header"
        class="font-large-heading text-[120px]/[80%] uppercase text-text-primary max-w-[180px] z-2 overflow-hidden"
      >
        Find your <span class="text-text-minimal">Path</span>
      </h1>
      <div
        id="paragraph-bg"
        class="absolute top-[300px] -left-[111px] w-[587px] h-[422px] bg-text-beige opacity-60"
      >
      </div>
      <div
        id="find-your-path-subheader"
        class="flex flex-col max-w-[220px] overflow-hidden"
      >
        <p class="font-copy text-base/[24px] text-text-primary z-2">
          Every animalâ€™s journey is different, from finding the food they love
          to knowing how much they need, and never running out again.
        </p>
        <p class="font-copy text-base/[24px] text-text-primary z-2">
          Explore three simple ways to feed instinctively and make every meal
          effortless, natural, and true to their nature.
        </p>
      </div>
    </section>

    <img
      id="arrow-1"
      src={Arrow1.src}
      alt="Arrow pointing right"
      class="arrow w-[100px] h-[110px] absolute top-[168px] left-64 z-3"
    />
    <Card
      id="card-subscribe"
      type="subscribe"
      className="absolute top-[212px] left-[330px] z-2"
    />
    <img
      id="arrow-2"
      src={Arrow2.src}
      alt="Arrow pointing right"
      class="arrow w-[100px] h-[110px] absolute top-[474px] left-[620px] z-2"
    />
    <Card
      id="card-trial"
      type="trial"
      className="absolute top-[272px] left-[700px]"
    />
    <img
      id="arrow-3"
      src={Arrow3.src}
      alt="Arrow pointing right"
      class="arrow w-[100px] h-[110px] absolute top-[526px] left-[990px] -rotate-[11px] z-2"
    />
    <Card
      id="card-pet"
      type="pet"
      className="absolute top-[332px] left-[1070px]"
    />
  </section>
</section>

<script>
  import { animateTitle } from "@/utils";
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);
  const trigger = document.getElementById("find-your-path");
  const title = document.getElementById("find-your-path-header");
  const description = document.getElementById("find-your-path-subheader");
  const paragraphBg = document.getElementById("paragraph-bg");

  // Expose playEntry/playLeave on the find-your-path root
  const findRoot = document.getElementById("find-your-path");
  if (findRoot) {
    (findRoot as any).playEntry = function () {
      return;
    };

    (findRoot as any).playLeave = function () {
      return;
    };
  }

  animateTitle({
    title: title,
    trigger: trigger,
    end: "bottom 95%",
  });
  animateTitle({
    title: description,
    trigger: trigger,
    end: "bottom 95%",
  });

  const timeline = gsap.timeline({
    scrollTrigger: {
      trigger: trigger,
      start: "top 50%",
      end: "bottom 40%",
      toggleActions: "play reverse restart restart",
    },
  });

  timeline.from(paragraphBg, {
    xPercent: -150,
    ease: "power2.out",
  });

  timeline
    .from(".card", {
      yPercent: -200,
      opacity: 0,
      stagger: 0.4,
      // duration: 1,
      ease: "power2.out",
    })
    .from(
      ".arrow",
      {
        yPercent: -200,
        opacity: 0,
        stagger: 0.4,
        // duration: 1,
        ease: "power2.out",
      },
      "-=2"
    );
</script>
