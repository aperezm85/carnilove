---
import videoSrc from "@/assets/hero/hero.mp4";
import HeroHeader from "@/components/HeroHeader.astro";
import ButtonRed from "@/components/shared/ButtonRed.astro";
---

<section
  id="hero-1"
  class="w-full h-full overflow-hidden absolute top-0 left-0 pt-20"
>
  <section class="absolute top-0 left-0 w-full h-full">
    <section
      class="bg-linear-[360deg,rgba(0,0,0,0)_18.93%,rgba(0,0,0,0.8)_100%] absolute top-0 left-0 w-full h-[300px]"
    >
    </section>
    <video
      autoplay
      muted
      loop
      playsinline
      class="w-full h-full object-cover z-0"
      preload="auto"
    >
      <source src={videoSrc} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </section>

  <HeroHeader textColor="text-text-invert" />

  <section
    class="absolute flex flex-col gap-4 items-center justify-center text-center grow h-full w-full top-0"
  >
    <h1
      id="hero-title"
      class="font-large-heading text-[150px]/[80%] text-text-invert uppercase"
    >
      Trust their instinct
    </h1>
    <p class="p1 text-text-invert max-w-[600px]">
      Wild origin meats & forest fruits as nature intended for dogs & cats.
    </p>
    <div class="flex flex-row gap-4">
      <ButtonRed>Shop dogs</ButtonRed>
      <ButtonRed>Shop cats</ButtonRed>
    </div>
  </section>
</section>

<script>
  import { gsap } from "gsap";
  import { SplitText } from "gsap/SplitText";

  gsap.registerPlugin(SplitText);
  const initSplitText = () => {
    const heroTitle = document.getElementById("hero-title");

    const splittedTitle = new SplitText(heroTitle, { type: "line,words" });

    gsap.set(heroTitle, {
      scale: 1.3,
      transformOrigin: "top center",
    });

    const tl = gsap.timeline({ delay: 0.5 });

    tl.from(splittedTitle.words, {
      y: 50,
      duration: 0.3,
      autoAlpha: 0,
      stagger: 0.05,
      ease: "power2.out",
    }).to(
      heroTitle,
      {
        scale: 1,
        duration: 1.3,
        ease: "power2.out",
      },
      "+=0.3"
    );
  };

  if (document.fonts && document.fonts.ready) {
    // Wait for all fonts declared in CSS to be loaded
    document.fonts.ready.then(initSplitText).catch(initSplitText);
  } else {
    // Fallback: wait for window load
    window.addEventListener("load", initSplitText, { once: true });
  }
</script>
